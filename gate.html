<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ŸÇŸÅŸÑ ÿßŸÑŸÇŸÑÿ®</title>

    <style>
      :root {
        --bg1: #fff5f7;
        --bg2: #ffe7ee;
        --rose: #c94762;
        --rose2: #ff6b8e;
        --ink: #3b1b24;
        --muted: rgba(59, 27, 36, 0.55);
        --cream: #fffaf6;
        --glass: rgba(255, 255, 255, 0.62);
        --shadow: 0 18px 55px rgba(201, 71, 98, 0.18);
        --ease: cubic-bezier(0.16, 1, 0.3, 1);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        font-family: 'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: var(--ink);
        background:
          radial-gradient(900px 520px at 20% 15%, rgba(255, 107, 142, 0.25) 0%, rgba(255, 107, 142, 0) 55%),
          radial-gradient(820px 520px at 80% 20%, rgba(201, 71, 98, 0.18) 0%, rgba(201, 71, 98, 0) 56%),
          linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
        overflow: hidden;
      }

      .app {
        min-height: 100dvh;
        display: grid;
        place-items: center;
        padding: 18px 14px 22px;
      }

      .stage {
        width: min(430px, 100%);
        position: relative;
        display: grid;
        place-items: center;
        gap: 14px;
        text-align: center;
      }

      .floating-hearts {
        position: absolute;
        inset: -20px;
        overflow: hidden;
        pointer-events: none;
        opacity: 0.45;
        filter: blur(0.2px);
      }

      .floating-hearts span {
        position: absolute;
        left: var(--x);
        bottom: -26px;
        width: 12px;
        height: 12px;
        transform: rotate(45deg);
        background: linear-gradient(180deg, rgba(201, 71, 98, 0.24), rgba(255, 107, 142, 0.16));
        border-radius: 3px;
        animation: floatUp var(--dur) linear infinite;
      }

      .floating-hearts span::before,
      .floating-hearts span::after {
        content: '';
        position: absolute;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: inherit;
      }

      .floating-hearts span::before {
        left: -6px;
        top: 0;
      }

      .floating-hearts span::after {
        top: -6px;
        left: 0;
      }

      @keyframes floatUp {
        0% {
          transform: translateY(0) rotate(45deg) scale(0.9);
          opacity: 0;
        }
        10% {
          opacity: 0.9;
        }
        100% {
          transform: translateY(-120vh) rotate(45deg) scale(1.3);
          opacity: 0;
        }
      }

      .title {
        margin: 0;
        font-weight: 700;
        letter-spacing: 0.2px;
        font-size: 18px;
        color: rgba(59, 27, 36, 0.86);
      }

      .subtitle {
        margin: 0;
        font-size: 13px;
        color: rgba(59, 27, 36, 0.6);
      }

      .lock {
        width: min(340px, 92vw);
        position: relative;
        padding-top: 18px;
        display: grid;
        place-items: center;
      }

      .lock__heart {
        width: 100%;
        aspect-ratio: 1 / 0.95;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.72) 0%, rgba(255, 255, 255, 0.52) 100%);
        border: 1px solid rgba(201, 71, 98, 0.14);
        box-shadow: var(--shadow);
        border-radius: 28px;
        position: relative;
        display: grid;
        place-items: center;
        overflow: hidden;
        transform: translateZ(0);
        animation: breathe 2.9s ease-in-out infinite;
      }

      .lock__heart::before,
      .lock__heart::after {
        content: '';
        position: absolute;
        inset: -2px;
        background:
          radial-gradient(160px 90px at 25% 28%, rgba(255, 107, 142, 0.25) 0%, rgba(255, 107, 142, 0) 65%),
          radial-gradient(160px 90px at 75% 28%, rgba(201, 71, 98, 0.18) 0%, rgba(201, 71, 98, 0) 65%);
        opacity: 0.75;
        pointer-events: none;
      }

      .lock__heart::after {
        inset: auto;
        left: 50%;
        top: 56%;
        width: 260px;
        height: 260px;
        transform: translateX(-50%) rotate(45deg);
        border-radius: 44px;
        background: rgba(201, 71, 98, 0.06);
        filter: blur(0.3px);
        opacity: 0.55;
      }

      @keyframes breathe {
        0%,
        100% {
          transform: translateZ(0) scale(1);
        }
        50% {
          transform: translateZ(0) scale(1.02);
        }
      }

      .lock__heartShape {
        position: absolute;
        inset: 18px;
        pointer-events: none;
        filter: drop-shadow(0 10px 35px rgba(201, 71, 98, 0.12));
      }

      .lock__heartShape svg {
        width: 100%;
        height: 100%;
        display: block;
      }

      .digits {
        position: relative;
        z-index: 2;
        width: min(300px, 88%);
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 10px;
        padding: 18px 16px;
        direction: ltr;
      }

      .digit {
        background: rgba(255, 255, 255, 0.62);
        border: 1px solid rgba(201, 71, 98, 0.14);
        border-radius: 14px;
        box-shadow: 0 10px 22px rgba(201, 71, 98, 0.1);
        padding: 10px 6px;
        display: grid;
        grid-template-rows: 18px 38px 18px;
        align-items: center;
        gap: 6px;
        user-select: none;
        touch-action: none;
      }

      .digit__btn {
        width: 100%;
        height: 18px;
        border: none;
        background: transparent;
        color: rgba(59, 27, 36, 0.6);
        font-size: 14px;
        line-height: 1;
        padding: 0;
        cursor: pointer;
        transition: transform 180ms var(--ease), opacity 180ms var(--ease);
        opacity: 0.85;
      }

      .digit__btn:active {
        transform: scale(0.92);
      }

      .digit__value {
        font-family: 'Tajawal', 'Cairo', system-ui, sans-serif;
        font-weight: 800;
        font-size: 28px;
        letter-spacing: 0.5px;
        color: rgba(59, 27, 36, 0.86);
        transition: transform 220ms var(--ease), filter 220ms var(--ease);
      }

      .digit.is-bumping .digit__value {
        transform: translateY(-1px) scale(1.05);
        filter: drop-shadow(0 10px 18px rgba(201, 71, 98, 0.12));
      }

      .hint {
        margin: 0;
        font-size: 12px;
        color: rgba(59, 27, 36, 0.4);
        opacity: 0;
        animation: hintFade 1.8s ease forwards;
      }

      @keyframes hintFade {
        0% {
          opacity: 0;
          transform: translateY(6px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .cta {
        margin-top: 6px;
        width: min(320px, 92vw);
        opacity: 0;
        transform: translateY(8px);
        pointer-events: none;
        transition: opacity 520ms var(--ease), transform 520ms var(--ease);
      }

      .cta.is-visible {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      .cta__btn {
        width: 100%;
        border: none;
        border-radius: 18px;
        padding: 14px 16px;
        background: linear-gradient(180deg, rgba(201, 71, 98, 0.96) 0%, rgba(255, 107, 142, 0.92) 100%);
        color: rgba(255, 255, 255, 0.98);
        font-weight: 800;
        font-size: 16px;
        cursor: pointer;
        box-shadow: 0 18px 44px rgba(201, 71, 98, 0.26);
        transition: transform 180ms var(--ease), filter 220ms var(--ease);
      }

      .cta__btn:active {
        transform: scale(0.985);
      }

      .cta__btn:focus-visible {
        outline: 3px solid rgba(201, 71, 98, 0.22);
        outline-offset: 3px;
      }

      .lock.is-unlocked .lock__heart {
        animation: unlockPulse 1.6s ease-in-out infinite;
        box-shadow: 0 0 0 rgba(255, 107, 142, 0), 0 22px 70px rgba(255, 107, 142, 0.28);
      }

      @keyframes unlockPulse {
        0%,
        100% {
          transform: translateZ(0) scale(1);
          filter: drop-shadow(0 0 26px rgba(255, 107, 142, 0.24));
        }
        50% {
          transform: translateZ(0) scale(1.03);
          filter: drop-shadow(0 0 34px rgba(255, 107, 142, 0.3));
        }
      }

      .lock.is-wrong .lock__heart {
        animation: wrongShake 420ms ease-in-out 1;
      }

      @keyframes wrongShake {
        0% {
          transform: translateX(0);
        }
        20% {
          transform: translateX(-7px);
        }
        40% {
          transform: translateX(7px);
        }
        60% {
          transform: translateX(-5px);
        }
        80% {
          transform: translateX(5px);
        }
        100% {
          transform: translateX(0);
        }
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      @media (prefers-reduced-motion: reduce) {
        .lock__heart,
        .floating-hearts span,
        .hint,
        .lock.is-unlocked .lock__heart {
          animation: none !important;
        }
        .digit__value,
        .digit__btn,
        .cta {
          transition: none !important;
        }
      }
    </style>
  </head>

  <body>
    <main class="app">
      <div class="stage" role="application" aria-label="ÿ®Ÿàÿßÿ®ÿ© ÿßŸÑŸáÿØŸäÿ©">
        <h1 class="title">ÿßŸÉÿ™ÿ®Ÿä ŸÉŸÑŸÖÿ© ÿßŸÑÿ≥ÿ±</h1>
        <p class="subtitle"> ŸÅÿßŸÉÿ±ÿßŸáÿß ÿ®ÿßŸÑÿ≥ÿßŸáŸÑ ŸÉÿØÿ©</p>

        <section class="lock" id="lock" aria-live="polite">
          <div class="lock__heart" role="group" aria-label="ŸÇŸÅŸÑ ÿπŸÑŸâ ÿ¥ŸÉŸÑ ŸÇŸÑÿ®">
            <div class="lock__heartShape" aria-hidden="true">
              <svg viewBox="0 0 100 90" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M50 83C24 66 10 49 10 33C10 21 18.5 12 30.5 12C38.7 12 45.8 16.4 50 22.6C54.2 16.4 61.3 12 69.5 12C81.5 12 90 21 90 33C90 49 76 66 50 83Z"
                  fill="rgba(201,71,98,0.08)"
                  stroke="rgba(201,71,98,0.16)"
                  stroke-width="1.2"
                />
              </svg>
            </div>

            <div class="digits" id="digits" aria-label="ÿ£ÿØÿÆŸÑ ÿ±ŸÖÿ≤ ŸÖŸÜ 6 ÿ£ÿ±ŸÇÿßŸÖ">
              <div class="digit" data-index="0">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 1</span>
              </div>
              <div class="digit" data-index="1">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 2</span>
              </div>
              <div class="digit" data-index="2">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 3</span>
              </div>
              <div class="digit" data-index="3">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 4</span>
              </div>
              <div class="digit" data-index="4">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 5</span>
              </div>
              <div class="digit" data-index="5">
                <button class="digit__btn digit__btn--up" type="button" aria-label="ÿ≤ŸäÿßÿØÿ© ÿßŸÑÿ±ŸÇŸÖ">‚Üë</button>
                <div class="digit__value" aria-hidden="true">0</div>
                <button class="digit__btn digit__btn--down" type="button" aria-label="ÿ™ŸÇŸÑŸäŸÑ ÿßŸÑÿ±ŸÇŸÖ">‚Üì</button>
                <span class="sr-only">ÿßŸÑÿ±ŸÇŸÖ 6</span>
              </div>
            </div>
          </div>

          <p class="hint" id="hint">Hint: ÿßŸÑŸäŸàŸÖ ÿßŸÑŸÑŸä ŸÖÿ≥ÿ™ŸÜŸäŸäŸÜŸá ŸÖŸÜ ÿ≤ŸÖÿßŸÜ ü§ç</p>
        </section>

        <div class="cta" id="cta">
          <button class="cta__btn" type="button" id="openGiftBtn">ÿßŸÅÿ™ÿ≠ ÿßŸÑŸáÿØŸäÿ© </button>
        </div>

        <audio id="unlockAudio" preload="none">
          <source src="unlock.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </main>

    <script>
      (function () {
        const GIFT_PAGE_URL = 'final.html';
        const PASSWORD = '122026';

        const lockEl = document.getElementById('lock');
        const digitsEl = document.getElementById('digits');
        const ctaEl = document.getElementById('cta');
        const openGiftBtn = document.getElementById('openGiftBtn');
        const unlockAudio = document.getElementById('unlockAudio');

        if (!lockEl || !digitsEl || !ctaEl || !openGiftBtn) return;

        const digitEls = Array.from(digitsEl.querySelectorAll('.digit'));
        const values = new Array(6).fill(0);

        let unlocked = false;
        let wrongTimer = null;

        function prefersReducedMotion() {
          return window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        }

        function loopDigit(n) {
          if (n < 0) return 9;
          if (n > 9) return 0;
          return n;
        }

        function render() {
          digitEls.forEach((el, i) => {
            const v = el.querySelector('.digit__value');
            if (v) v.textContent = String(values[i]);
          });

          checkCode(false);
        }

        function bump(el) {
          el.classList.remove('is-bumping');
          void el.offsetWidth;
          el.classList.add('is-bumping');
          window.setTimeout(() => el.classList.remove('is-bumping'), 220);
        }

        function setDigit(index, nextValue) {
          values[index] = loopDigit(nextValue);
          const el = digitEls[index];
          if (el) bump(el);
          render();
        }

        function inc(index) {
          setDigit(index, values[index] + 1);
        }

        function dec(index) {
          setDigit(index, values[index] - 1);
        }

        function currentCode() {
          return values.join('');
        }

        function playUnlockSound() {
          if (!unlockAudio) return;
          try {
            unlockAudio.currentTime = 0;
            unlockAudio.volume = 0.35;
            unlockAudio.play().catch(() => {});
          } catch {
            // ignore
          }
        }

        function showCTA() {
          ctaEl.classList.add('is-visible');
        }

        function markWrong() {
          if (wrongTimer) window.clearTimeout(wrongTimer);
          lockEl.classList.remove('is-wrong');
          void lockEl.offsetWidth;
          lockEl.classList.add('is-wrong');
          wrongTimer = window.setTimeout(() => lockEl.classList.remove('is-wrong'), 520);
        }

        function unlock() {
          if (unlocked) return;
          unlocked = true;
          lockEl.classList.add('is-unlocked');
          showCTA();
          if (!prefersReducedMotion()) playUnlockSound();
        }

        function checkCode(shouldShakeOnWrong) {
          if (unlocked) return;
          const ok = currentCode() === PASSWORD;
          if (ok) {
            unlock();
          } else if (shouldShakeOnWrong) {
            markWrong();
          }
        }

        function attachButtons(el, index) {
          const up = el.querySelector('.digit__btn--up');
          const down = el.querySelector('.digit__btn--down');

          up && up.addEventListener('click', () => inc(index));
          down && down.addEventListener('click', () => dec(index));
        }

        function attachSwipe(el, index) {
          let startY = 0;
          let active = false;

          const threshold = 10;

          function onStart(e) {
            if (unlocked) return;
            active = true;
            startY = e.touches ? e.touches[0].clientY : e.clientY;
          }

          function onMove(e) {
            if (!active || unlocked) return;
            const y = e.touches ? e.touches[0].clientY : e.clientY;
            const dy = y - startY;
            if (Math.abs(dy) < threshold) return;

            if (dy < 0) inc(index);
            else dec(index);

            startY = y;
            e.preventDefault();
          }

          function onEnd() {
            active = false;
          }

          el.addEventListener('touchstart', onStart, { passive: true });
          el.addEventListener('touchmove', onMove, { passive: false });
          el.addEventListener('touchend', onEnd, { passive: true });
          el.addEventListener('touchcancel', onEnd, { passive: true });

          el.addEventListener('mousedown', (e) => {
            onStart(e);
          });

          window.addEventListener(
            'mousemove',
            (e) => {
              if (!active) return;
              onMove(e);
            },
            { passive: false }
          );

          window.addEventListener('mouseup', () => onEnd(), { passive: true });
        }

        digitEls.forEach((el, index) => {
          attachButtons(el, index);
          attachSwipe(el, index);
        });

        openGiftBtn.addEventListener('click', () => {
          if (!unlocked) {
            checkCode(true);
            return;
          }
          window.location.href = GIFT_PAGE_URL;
        });

        // If user tries to leave without unlocking, give gentle feedback by shaking once
        window.setTimeout(() => {
          if (!unlocked) checkCode(false);
        }, 240);

        render();

        // Optional: shake when user taps title area with wrong code (keeps mood, no text errors)
        lockEl.addEventListener('click', () => {
          if (!unlocked) checkCode(true);
        });
      })();
    </script>
  </body>
</html>
